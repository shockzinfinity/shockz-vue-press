<!DOCTYPE html>
<html lang="ko-KR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue.js 관련 | ironpot devLog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/img/icons/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" sizes="180x180" href="/img/icons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/img/icons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/img/icons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/icons/favicon-16x16.png">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-MM4TDVZJ85"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-MM4TDVZJ85');
    </script>
    <link rel="alternate" type="application/rss+xml" href="https://shockzinfinity.github.io/rss.xml" title="ironpot devLog RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://shockzinfinity.github.io/feed.atom" title="ironpot devLog Atom Feed">
    <link rel="alternate" type="application/json" href="https://shockzinfinity.github.io/feed.json" title="ironpot devLog JSON Feed">
    <meta name="description" content="Vue.js 관련을 다룹니다.">
    <meta name="keywords" content="vuejs">
    <meta name="google-site-verification" content="hwS5SAeZJGMx-RCbFtzbcv0IGdU4nIN8mAfE2iAMhSA">
    <meta name="naver-site-verification" content="cd32f721debd9633141e4a04c83fad98d36a5abc">
    <meta name="theme-color" content="#2196f3">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="ironPot">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="msapplication-TileColor" content="#2196f3">
    <meta name="msapplication-TileImage" content="/img/icons/ms-icon-144x144.png">
    <meta name="og:type" content="website">
    <meta name="og:title" content="ironPot42 dev log site">
    <meta name="og:description" content="Development log for ironPot42">
    <meta name="og:url" content="https://shockzinfinity.github.io">
    <meta name="og:image" content="/img/logo.png">
    
    <link rel="preload" href="/assets/css/0.styles.0ac55d30.css" as="style"><link rel="preload" href="/assets/js/app.235aa418.js" as="script"><link rel="preload" href="/assets/js/32.2f97a545.js" as="script"><link rel="preload" href="/assets/js/2.c6e841d7.js" as="script"><link rel="preload" href="/assets/js/1.be22eaca.js" as="script"><link rel="preload" href="/assets/js/73.49fd3654.js" as="script"><link rel="preload" href="/assets/js/39.8f7876c0.js" as="script"><link rel="preload" href="/assets/js/40.0f869326.js" as="script"><link rel="prefetch" href="/assets/js/10.08dc9b50.js"><link rel="prefetch" href="/assets/js/11.586c6ce3.js"><link rel="prefetch" href="/assets/js/12.3b1f2e73.js"><link rel="prefetch" href="/assets/js/13.cf93a349.js"><link rel="prefetch" href="/assets/js/14.48be74c2.js"><link rel="prefetch" href="/assets/js/15.b5a6f882.js"><link rel="prefetch" href="/assets/js/16.5a3ab8c8.js"><link rel="prefetch" href="/assets/js/17.b01ce45e.js"><link rel="prefetch" href="/assets/js/18.8afaf987.js"><link rel="prefetch" href="/assets/js/19.db7b48de.js"><link rel="prefetch" href="/assets/js/20.b3b734fb.js"><link rel="prefetch" href="/assets/js/21.5252a576.js"><link rel="prefetch" href="/assets/js/22.6f43ce1b.js"><link rel="prefetch" href="/assets/js/23.700d3cb4.js"><link rel="prefetch" href="/assets/js/24.447eed5d.js"><link rel="prefetch" href="/assets/js/25.f2356c7a.js"><link rel="prefetch" href="/assets/js/26.b392f38f.js"><link rel="prefetch" href="/assets/js/27.a6755c58.js"><link rel="prefetch" href="/assets/js/28.12ccef81.js"><link rel="prefetch" href="/assets/js/29.ac459999.js"><link rel="prefetch" href="/assets/js/3.b9af6c4f.js"><link rel="prefetch" href="/assets/js/30.b335756e.js"><link rel="prefetch" href="/assets/js/31.ca339667.js"><link rel="prefetch" href="/assets/js/33.cce37131.js"><link rel="prefetch" href="/assets/js/34.7f1ed12a.js"><link rel="prefetch" href="/assets/js/35.83f70d4a.js"><link rel="prefetch" href="/assets/js/36.f3b23cd2.js"><link rel="prefetch" href="/assets/js/37.7a2df46c.js"><link rel="prefetch" href="/assets/js/38.c2c82975.js"><link rel="prefetch" href="/assets/js/4.93d7c993.js"><link rel="prefetch" href="/assets/js/41.ad359ed2.js"><link rel="prefetch" href="/assets/js/42.8c27b04e.js"><link rel="prefetch" href="/assets/js/43.0b5daa81.js"><link rel="prefetch" href="/assets/js/44.46df54b4.js"><link rel="prefetch" href="/assets/js/45.e12547b7.js"><link rel="prefetch" href="/assets/js/46.0fde9b14.js"><link rel="prefetch" href="/assets/js/47.4c184099.js"><link rel="prefetch" href="/assets/js/48.67492e7a.js"><link rel="prefetch" href="/assets/js/49.0cd0b7c6.js"><link rel="prefetch" href="/assets/js/5.a6223022.js"><link rel="prefetch" href="/assets/js/50.0ed20d79.js"><link rel="prefetch" href="/assets/js/51.520e4c33.js"><link rel="prefetch" href="/assets/js/52.f770fb14.js"><link rel="prefetch" href="/assets/js/53.131a171e.js"><link rel="prefetch" href="/assets/js/54.f6f8a2b1.js"><link rel="prefetch" href="/assets/js/55.32e848a1.js"><link rel="prefetch" href="/assets/js/56.a08a9a6b.js"><link rel="prefetch" href="/assets/js/57.56f4b7ba.js"><link rel="prefetch" href="/assets/js/58.da91841d.js"><link rel="prefetch" href="/assets/js/59.169bbdf4.js"><link rel="prefetch" href="/assets/js/6.351cefac.js"><link rel="prefetch" href="/assets/js/60.a6361cfc.js"><link rel="prefetch" href="/assets/js/61.8a12f03b.js"><link rel="prefetch" href="/assets/js/62.a654d72a.js"><link rel="prefetch" href="/assets/js/63.bba47650.js"><link rel="prefetch" href="/assets/js/64.49ea6d5e.js"><link rel="prefetch" href="/assets/js/65.c9a180db.js"><link rel="prefetch" href="/assets/js/66.59af28e1.js"><link rel="prefetch" href="/assets/js/67.b596b57d.js"><link rel="prefetch" href="/assets/js/68.12a66673.js"><link rel="prefetch" href="/assets/js/69.774d628f.js"><link rel="prefetch" href="/assets/js/7.76cb897b.js"><link rel="prefetch" href="/assets/js/70.1fc0cd62.js"><link rel="prefetch" href="/assets/js/71.733ff8e5.js"><link rel="prefetch" href="/assets/js/72.c256780c.js"><link rel="prefetch" href="/assets/js/74.723f0509.js"><link rel="prefetch" href="/assets/js/75.79e7f053.js"><link rel="prefetch" href="/assets/js/76.8b51eb2d.js"><link rel="prefetch" href="/assets/js/77.667ebbe2.js"><link rel="prefetch" href="/assets/js/78.e4f6aa85.js"><link rel="prefetch" href="/assets/js/79.0c959f73.js"><link rel="prefetch" href="/assets/js/80.29f025d5.js"><link rel="prefetch" href="/assets/js/81.537c9575.js"><link rel="prefetch" href="/assets/js/82.f30d4d39.js"><link rel="prefetch" href="/assets/js/83.00bfcb63.js"><link rel="prefetch" href="/assets/js/84.8fd4a10e.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.74777bb7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0ac55d30.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-9cf26668><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">ironpot devLog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/tags.html" class="nav-link">
  tags
</a></div><div class="nav-item"><a href="/tutorial/" class="nav-link">
  Tutorial
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Developement Log" class="dropdown-title"><span class="title">devLog</span> <span class="arrow down"></span></button> <button type="button" aria-label="Developement Log" class="mobile-dropdown-title"><span class="title">devLog</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dev-log/centos.html" class="nav-link">
  CentOS 8
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/podman.html" class="nav-link">
  Podman
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/docker.html" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/xwiki.html" class="nav-link">
  Xwiki
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/synology.html" class="nav-link">
  Synology NAS
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/gitlab.html" class="nav-link">
  GitLab
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/github.html" class="nav-link">
  GitHub
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/ssl.html" class="nav-link">
  SSL
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/nginx.html" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/dotnetcore.html" class="nav-link">
  .net core
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/konva.html" class="nav-link">
  Konva Test
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/vuepress.html" class="nav-link">
  VuePress
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/vuejs.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Vue.js
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/mssql.html" class="nav-link">
  mssql
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/maria.html" class="nav-link">
  mariaDB
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/efcore.html" class="nav-link">
  EF core
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/wordpress.html" class="nav-link">
  WordPress
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/npm.html" class="nav-link">
  NPM
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/jenkins.html" class="nav-link">
  Jenkins
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/code-server.html" class="nav-link">
  code-server
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/aws.html" class="nav-link">
  aws
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/linux.html" class="nav-link">
  linux
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/selenium.html" class="nav-link">
  selenium
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/python.html" class="nav-link">
  python
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/kubernetes.html" class="nav-link">
  kubernetes
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/path-polisher.html" class="nav-link">
  PathPolisher
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="etc" class="dropdown-title"><span class="title">etc</span> <span class="arrow down"></span></button> <button type="button" aria-label="etc" class="mobile-dropdown-title"><span class="title">etc</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/etc/devEnv.html" class="nav-link">
  개발환경설정
</a></li><li class="dropdown-item"><!----> <a href="/etc/vscode-debugging.html" class="nav-link">
  vscode-debugging
</a></li><li class="dropdown-item"><!----> <a href="/etc/vscode.html" class="nav-link">
  VS Code 관련
</a></li><li class="dropdown-item"><!----> <a href="/etc/mac-etc.html" class="nav-link">
  mac 사용관련
</a></li><li class="dropdown-item"><!----> <a href="/etc/iPad.html" class="nav-link">
  iPad 사용관련
</a></li><li class="dropdown-item"><!----> <a href="/etc/markdown.html" class="nav-link">
  markdown
</a></li><li class="dropdown-item"><!----> <a href="/etc/windows.html" class="nav-link">
  windows
</a></li><li class="dropdown-item"><!----> <a href="/etc/php.html" class="nav-link">
  PHP
</a></li><li class="dropdown-item"><!----> <a href="/etc/tools.html" class="nav-link">
  Tools
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/tags.html" class="nav-link">
  tags
</a></div><div class="nav-item"><a href="/tutorial/" class="nav-link">
  Tutorial
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Developement Log" class="dropdown-title"><span class="title">devLog</span> <span class="arrow down"></span></button> <button type="button" aria-label="Developement Log" class="mobile-dropdown-title"><span class="title">devLog</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dev-log/centos.html" class="nav-link">
  CentOS 8
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/podman.html" class="nav-link">
  Podman
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/docker.html" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/xwiki.html" class="nav-link">
  Xwiki
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/synology.html" class="nav-link">
  Synology NAS
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/gitlab.html" class="nav-link">
  GitLab
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/github.html" class="nav-link">
  GitHub
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/ssl.html" class="nav-link">
  SSL
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/nginx.html" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/dotnetcore.html" class="nav-link">
  .net core
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/konva.html" class="nav-link">
  Konva Test
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/vuepress.html" class="nav-link">
  VuePress
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/vuejs.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Vue.js
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/mssql.html" class="nav-link">
  mssql
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/maria.html" class="nav-link">
  mariaDB
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/efcore.html" class="nav-link">
  EF core
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/wordpress.html" class="nav-link">
  WordPress
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/npm.html" class="nav-link">
  NPM
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/jenkins.html" class="nav-link">
  Jenkins
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/code-server.html" class="nav-link">
  code-server
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/aws.html" class="nav-link">
  aws
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/linux.html" class="nav-link">
  linux
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/selenium.html" class="nav-link">
  selenium
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/python.html" class="nav-link">
  python
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/kubernetes.html" class="nav-link">
  kubernetes
</a></li><li class="dropdown-item"><!----> <a href="/dev-log/path-polisher.html" class="nav-link">
  PathPolisher
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="etc" class="dropdown-title"><span class="title">etc</span> <span class="arrow down"></span></button> <button type="button" aria-label="etc" class="mobile-dropdown-title"><span class="title">etc</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/etc/devEnv.html" class="nav-link">
  개발환경설정
</a></li><li class="dropdown-item"><!----> <a href="/etc/vscode-debugging.html" class="nav-link">
  vscode-debugging
</a></li><li class="dropdown-item"><!----> <a href="/etc/vscode.html" class="nav-link">
  VS Code 관련
</a></li><li class="dropdown-item"><!----> <a href="/etc/mac-etc.html" class="nav-link">
  mac 사용관련
</a></li><li class="dropdown-item"><!----> <a href="/etc/iPad.html" class="nav-link">
  iPad 사용관련
</a></li><li class="dropdown-item"><!----> <a href="/etc/markdown.html" class="nav-link">
  markdown
</a></li><li class="dropdown-item"><!----> <a href="/etc/windows.html" class="nav-link">
  windows
</a></li><li class="dropdown-item"><!----> <a href="/etc/php.html" class="nav-link">
  PHP
</a></li><li class="dropdown-item"><!----> <a href="/etc/tools.html" class="nav-link">
  Tools
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Vue.js 관련</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev-log/vuejs.html#nginx-vue-js-배포를-위한-설정" class="sidebar-link">Nginx + Vue.js 배포를 위한 설정</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dev-log/vuejs.html#step-1-기본-위치-설정" class="sidebar-link">Step 1. 기본 위치 설정</a></li><li class="sidebar-sub-header"><a href="/dev-log/vuejs.html#step-2-certbot-을-통한-인증서-생성" class="sidebar-link">Step 2. certbot 을 통한 인증서 생성</a></li><li class="sidebar-sub-header"><a href="/dev-log/vuejs.html#step-3-ssl-적용" class="sidebar-link">Step 3. ssl 적용</a></li><li class="sidebar-sub-header"><a href="/dev-log/vuejs.html#step-4-dist-vue-js-앱-배포" class="sidebar-link">Step 4. /dist vue.js 앱 배포</a></li></ul></li><li><a href="/dev-log/vuejs.html#nginx-vue-js-를-docker-를-통해-배포" class="sidebar-link">nginx + vue.js 를 docker 를 통해 배포</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue-js"><a href="#vue-js" class="header-anchor">#</a> Vue.js</h1> <div class="tags" data-v-77ca7535>Tags: <a href="/tags.html#vuejs" class="tag" data-v-77ca7535>vuejs</a></div> <p></p><div class="table-of-contents"><ul><li><a href="#nginx-vue-js-배포를-위한-설정">Nginx + Vue.js 배포를 위한 설정</a><ul><li><a href="#step-1-기본-위치-설정">Step 1. 기본 위치 설정</a></li><li><a href="#step-2-certbot-을-통한-인증서-생성">Step 2. certbot 을 통한 인증서 생성</a></li><li><a href="#step-3-ssl-적용">Step 3. ssl 적용</a></li><li><a href="#step-4-dist-vue-js-앱-배포">Step 4. /dist vue.js 앱 배포</a></li></ul></li><li><a href="#nginx-vue-js-를-docker-를-통해-배포">nginx + vue.js 를 docker 를 통해 배포</a></li></ul></div><p></p> <h2 id="nginx-vue-js-배포를-위한-설정"><a href="#nginx-vue-js-배포를-위한-설정" class="header-anchor">#</a> Nginx + Vue.js 배포를 위한 설정</h2> <h3 id="step-1-기본-위치-설정"><a href="#step-1-기본-위치-설정" class="header-anchor">#</a> Step 1. 기본 위치 설정</h3> <ul><li>target server: linux (centos 8)</li> <li>배포 방식: docker-compose 를 이용한 nginx container</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 배포 디렉토리</span>
$ <span class="token function">mkdir</span> dist
<span class="token comment"># certbot 인증서 저장경로</span>
$ <span class="token function">mkdir</span> certbot-etc
<span class="token comment"># nginx config</span>
$ <span class="token function">mkdir</span> nginx-conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>dist</code> : vue app 빌드한 결과를 여기에 넣고 호스팅하기 위한 디렉토리</li> <li><code>certbot-etc</code> : letsencrypt 인증서 저장 디렉토리</li> <li><code>nginx-conf</code> : nginx config 디렉토리</li></ul> <h3 id="step-2-certbot-을-통한-인증서-생성"><a href="#step-2-certbot-을-통한-인증서-생성" class="header-anchor">#</a> Step 2. certbot 을 통한 인증서 생성</h3> <ul><li>인증서 생성만을 위한 <code>nginx.conf</code> 작성</li></ul> <div class="language-bash line-numbers-mode"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-bash"><code>server <span class="token punctuation">{</span>
	listen <span class="token number">80</span><span class="token punctuation">;</span>
	listen <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:80<span class="token punctuation">;</span>

	server_name temp.temp.io<span class="token punctuation">;</span>
	index index.html index.htm<span class="token punctuation">;</span>
	root /var/www/html<span class="token punctuation">;</span>

	location ~ /.well-known/acme-challenge <span class="token punctuation">{</span>
		allow all<span class="token punctuation">;</span>
		root /var/www/html<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	location / <span class="token punctuation">{</span>
		try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.html<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	location ~ /<span class="token punctuation">\</span>.ht <span class="token punctuation">{</span>
		deny all<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	location <span class="token operator">=</span> /favicon.ico <span class="token punctuation">{</span>
		log_not_found off<span class="token punctuation">;</span> access_log off<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	location <span class="token operator">=</span> /robots.txt <span class="token punctuation">{</span>
		log_not_found off<span class="token punctuation">;</span> access_log off<span class="token punctuation">;</span> allow all<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	location ~* <span class="token punctuation">\</span>.<span class="token punctuation">(</span>css<span class="token operator">|</span>gif<span class="token operator">|</span>ico<span class="token operator">|</span>jpeg<span class="token operator">|</span>jpg<span class="token operator">|</span>js<span class="token operator">|</span>png<span class="token punctuation">)</span>$ <span class="token punctuation">{</span>
		expires max<span class="token punctuation">;</span>
		log_not_found off<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><ul><li><code>docker-compose.yml</code> 를 통해 인증서 생성 시작</li></ul> <div class="language-yml line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-yml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3'</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
    <span class="token key atrule">certbot</span><span class="token punctuation">:</span>
        <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> webserver
        <span class="token key atrule">image</span><span class="token punctuation">:</span> certbot/certbot
        <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> ./certbot<span class="token punctuation">-</span>etc<span class="token punctuation">:</span>/etc/letsencrypt
            <span class="token punctuation">-</span> ./dist<span class="token punctuation">:</span>/var/www/html
        <span class="token key atrule">command</span><span class="token punctuation">:</span> certonly <span class="token punctuation">-</span><span class="token punctuation">-</span>webroot <span class="token punctuation">-</span><span class="token punctuation">-</span>webroot<span class="token punctuation">-</span>path=/var/www/html <span class="token punctuation">-</span><span class="token punctuation">-</span>email temp@gmail.com <span class="token punctuation">-</span><span class="token punctuation">-</span>agree<span class="token punctuation">-</span>tos <span class="token punctuation">-</span><span class="token punctuation">-</span>no<span class="token punctuation">-</span>eff<span class="token punctuation">-</span>email <span class="token punctuation">-</span><span class="token punctuation">-</span>staging <span class="token punctuation">-</span>d temp.temp.io

    <span class="token key atrule">webserver</span><span class="token punctuation">:</span>
        <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>alpine
        <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token string">&quot;80:80&quot;</span>
            <span class="token punctuation">-</span> <span class="token string">&quot;443:443&quot;</span>
        <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> ./dist<span class="token punctuation">:</span>/var/www/html
            <span class="token punctuation">-</span> ./nginx<span class="token punctuation">-</span>conf<span class="token punctuation">:</span>/etc/nginx/conf.d
            <span class="token punctuation">-</span> ./certbot<span class="token punctuation">-</span>etc<span class="token punctuation">:</span>/etc/letsencrypt
        <span class="token key atrule">networks</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> app<span class="token punctuation">-</span>network

<span class="token key atrule">volumes</span><span class="token punctuation">:</span>
    <span class="token key atrule">certbot-etc</span><span class="token punctuation">:</span>
    <span class="token key atrule">dist</span><span class="token punctuation">:</span>
    <span class="token key atrule">nginx-conf</span><span class="token punctuation">:</span>

<span class="token key atrule">networks</span><span class="token punctuation">:</span>
    <span class="token key atrule">app-network</span><span class="token punctuation">:</span>
        <span class="token key atrule">driver</span><span class="token punctuation">:</span> bridge
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>certbot 의 --staging 은 테스트 한다는 의미<br>
email, domain 은 적절하게 수정</p></div> <div class="language-bash line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span>
   Name                 Command               State                     Ports
-----------------------------------------------------------------------------------------------
certbot      certbot certonly <span class="token parameter variable">--webroot</span> <span class="token punctuation">..</span>.   Exit <span class="token number">0</span>
webserver    /docker-entrypoint.sh ngin <span class="token punctuation">..</span>.   Up       <span class="token number">0.0</span>.0.0:443-<span class="token operator">&gt;</span><span class="token number">443</span>/tcp, <span class="token number">0.0</span>.0.0:80-<span class="token operator">&gt;</span><span class="token number">80</span>/tcp
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>certbot 은 Exit 0 가 되는 것이 맞음. 인증서 생성이 되면 ./certbot-etc 에 가면 확인할 수 있음</p></div> <ul><li><code>docker-compose.yml</code> 의 certbot command 수정</li></ul> <div class="language-bash line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-bash"><code><span class="token punctuation">..</span>.
    certbot:
        depends_on:
            - webserver
        image: certbot/certbot
        volumes:
            - ./certbot-etc:/etc/letsencrypt
            - ./dist:/var/www/html
        command: certonly <span class="token parameter variable">--webroot</span> --webroot-path<span class="token operator">=</span>/var/www/html <span class="token parameter variable">--email</span> temp@gmail.com --agree-tos --no-eff-email --force-renewal <span class="token parameter variable">-d</span> temp.temp.io
<span class="token punctuation">..</span>.
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> up --force-recreate --no-deps certbot
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="step-3-ssl-적용"><a href="#step-3-ssl-적용" class="header-anchor">#</a> Step 3. ssl 적용</h3> <ul><li>ssl 관련 설정 다운로드</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">curl</span> <span class="token parameter variable">-sSLo</span> nginx-conf/options-ssl-nginx.conf https://raw.githubusercontent.com/certbot/certbot/master/certbot-nginx/certbot_nginx/_internal/tls_configs/options-ssl-nginx.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>nginx 설정 수정</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>server <span class="token punctuation">{</span>
	listen <span class="token number">80</span><span class="token punctuation">;</span>
	listen <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:80<span class="token punctuation">;</span>

	server_name temp.temp.io<span class="token punctuation">;</span>
	index index.html index.htm<span class="token punctuation">;</span>
	root /var/www/html<span class="token punctuation">;</span>

	location ~ /.well-known/acme-challenge <span class="token punctuation">{</span>
		allow all<span class="token punctuation">;</span>
		root /var/www/html<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	location / <span class="token punctuation">{</span>
		rewrite ^ https://<span class="token variable">$host</span><span class="token variable">$request_uri</span>? permanent<span class="token punctuation">;</span>
		try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.html<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

server <span class="token punctuation">{</span>
	listen <span class="token number">443</span> ssl http2<span class="token punctuation">;</span>
	listen <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:443 ssl http2<span class="token punctuation">;</span>
	server_name temp.temp.io<span class="token punctuation">;</span>

	index index.html index.htm<span class="token punctuation">;</span>
	root /var/www/html<span class="token punctuation">;</span>

	server_tokens off<span class="token punctuation">;</span>
	client_max_body_size 100M<span class="token punctuation">;</span>

	ssl_certificate /etc/letsencrypt/live/temp.temp.io/fullchain.pem<span class="token punctuation">;</span>
	ssl_certificate_key /etc/letsencrypt/live/temp.temp.io/privkey.pem<span class="token punctuation">;</span>
	ssl_trusted_certificate /etc/letsencrypt/live/temp.temp.io/chain.pem<span class="token punctuation">;</span>
	include /etc/nginx/conf.d/options-ssl-nginx.conf<span class="token punctuation">;</span>

	add_header X-Frame-Options <span class="token string">&quot;SAMEORIGIN&quot;</span> always<span class="token punctuation">;</span>
	add_header X-XSS-Protection <span class="token string">&quot;1; mode=block&quot;</span> always<span class="token punctuation">;</span>
	add_header X-Content-Type-Options <span class="token string">&quot;nosniff&quot;</span> always<span class="token punctuation">;</span>
	add_header Referrer-Policy <span class="token string">&quot;no-referrer-when-downgrade&quot;</span> always<span class="token punctuation">;</span>
	add_header Content-Security-Policy <span class="token string">&quot;default-src * data: 'unsafe-eval' 'unsafe-inline'&quot;</span> always<span class="token punctuation">;</span>
	<span class="token comment"># add_header Strict-Transport-Security &quot;max-age=31536000; includeSubDomains; preload&quot; always;</span>
	<span class="token comment"># enable strict transport security only if you understand the implications</span>

	location / <span class="token punctuation">{</span>
		try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.html<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span> --force-recreate --no-deps webserver
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>인증서 자동 갱신을 위한 스크립트 작성 후 crontab 에 등록</li> <li><code>ssl_renew.sh</code></li></ul> <div class="language-bash line-numbers-mode"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token assign-left variable">COMPOSE</span><span class="token operator">=</span><span class="token string">&quot;/usr/local/bin/docker-compose --no-ansi&quot;</span>
<span class="token assign-left variable">DOCKER</span><span class="token operator">=</span><span class="token string">&quot;/usr/bin/docker&quot;</span>

<span class="token builtin class-name">cd</span> /home/temp/vuejsapp/
<span class="token variable">$COMPOSE</span> run certbot renew <span class="token operator">&amp;&amp;</span> <span class="token variable">$COMPOSE</span> <span class="token function">kill</span> <span class="token parameter variable">-s</span> SIGHUP webserver
<span class="token variable">$DOCKER</span> system prune <span class="token parameter variable">-af</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">chmod</span> +x ssl_renew.sh
$ <span class="token function">sudo</span> <span class="token function">crontab</span> <span class="token parameter variable">-e</span>

<span class="token number">0</span> <span class="token number">12</span> * * * /home/temp/vuejsapp/ssl_renew.sh <span class="token operator">&gt;&gt;</span> /var/log/cron.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>docker-compose.yml</code> 의 certbot command 수정</li></ul> <div class="language-bash line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-bash"><code><span class="token punctuation">..</span>.
    certbot:
        depends_on:
            - webserver
        image: certbot/certbot
        volumes:
            - ./certbot-etc:/etc/letsencrypt
            - ./dist:/var/www/html
        command: renew
<span class="token punctuation">..</span>.
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> up --force-recreate --no-deps certbot
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="step-4-dist-vue-js-앱-배포"><a href="#step-4-dist-vue-js-앱-배포" class="header-anchor">#</a> Step 4. /dist vue.js 앱 배포</h3> <ul><li><code>yarn build</code> 등을 통해 빌드된 결과를 <code>/dist</code> 에 복사</li></ul> <h2 id="nginx-vue-js-를-docker-를-통해-배포"><a href="#nginx-vue-js-를-docker-를-통해-배포" class="header-anchor">#</a> nginx + vue.js 를 docker 를 통해 배포</h2> <ul><li>호스트에 이미 docker 를 통한 reverse proxy 가 설정되어 있다는 가정하에 시작합니다.</li> <li>docker 를 통한 reverse proxy 설정은 <a href="https://shockzinfinity.github.io/dev-log/nginx.html#nginx-reverse-proxy-containerizing" target="_blank" rel="noopener noreferrer">다음<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>을 참고합니다.</li> <li>참조: <a href="https://kr.vuejs.org/v2/cookbook/dockerize-vuejs-app.html#Real-World-Example" target="_blank" rel="noopener noreferrer">Dockrize Vue.js App<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>해당 앱 디렉토리에 <code>nginx.conf</code> 를 추가합니다. (vue router history mode 관련 설정을 추가합니다.)</li></ul> <div class="language-nginx line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
  <span class="token directive"><span class="token keyword">listen</span> <span class="token number">8080</span></span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">client_max_body_size</span> <span class="token number">5M</span></span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">alias</span> /usr/share/nginx/html/</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.html</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li><code>Dockerfile</code></li></ul> <div class="language-docker line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-docker"><code><span class="token comment"># build stage</span>
<span class="token instruction"><span class="token keyword">FROM</span> node:lts-alpine <span class="token keyword">as</span> build-stage</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>
<span class="token instruction"><span class="token keyword">COPY</span> package*.json ./</span>
<span class="token instruction"><span class="token keyword">RUN</span> yarn</span>
<span class="token instruction"><span class="token keyword">COPY</span> . .</span>
<span class="token instruction"><span class="token keyword">RUN</span> yarn build</span>

<span class="token comment"># production stage</span>
<span class="token instruction"><span class="token keyword">FROM</span> nginx:stable-alpine <span class="token keyword">as</span> production-stage</span>
<span class="token instruction"><span class="token keyword">COPY</span> ./nginx.conf /etc/nginx/conf.d/default.conf</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">build-stage</span></span> /app/dist /usr/share/nginx/html</span>
<span class="token instruction"><span class="token keyword">EXPOSE</span> 8080</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;nginx&quot;</span>, <span class="token string">&quot;-g&quot;</span>, <span class="token string">&quot;daemon off;&quot;</span>]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>docker build 를 통해 이미지 생성 후 ghcr.io 에 배포는 다음과 같이 진행했습니다.</li> <li>ghcr.io 로그인은 <a href="https://shockzinfinity.github.io/dev-log/github.html#github-container-registry-%E1%84%8B%E1%85%A6-%E1%84%8B%E1%85%A5%E1%86%B8%E1%84%85%E1%85%A9%E1%84%83%E1%85%B3-%E1%84%92%E1%85%A1%E1%84%80%E1%85%B5-%E1%84%8B%E1%85%B1%E1%84%92%E1%85%A1%E1%86%AB-%E1%84%8C%E1%85%AE%E1%86%AB%E1%84%87%E1%85%B5" target="_blank" rel="noopener noreferrer">다음<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>을 참고합니다.</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker</span> build <span class="token parameter variable">-t</span> ghcr.io/shockzinfinity/vuejs-app:latest <span class="token builtin class-name">.</span>
<span class="token comment"># ghcr.io 에 로그인 되어있다고 가정</span>
$ <span class="token function">docker</span> push ghcr.io/shockzinfinity/vuejs-app:latest
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div> <ul><li><code>docker-compose.yml</code></li></ul> <div class="language-yml line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><div class="highlighted"> </div><br></div><pre class="language-yml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3'</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">vuejs-app</span><span class="token punctuation">:</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> vuejs<span class="token punctuation">-</span>app
    <span class="token key atrule">image</span><span class="token punctuation">:</span> ghcr.io/shockzinfinity/vuejs<span class="token punctuation">-</span>app<span class="token punctuation">:</span>latest
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> VIRTUAL_HOST=vuejs.your.domain
      <span class="token punctuation">-</span> VIRTUAL_PORT=8080
      <span class="token punctuation">-</span> LETSENCRYPT_HOST=vuejs.your.domain
      <span class="token punctuation">-</span> LETSCRYPT_EMAIL=email@your.domain

<span class="token key atrule">networks</span><span class="token punctuation">:</span>
  <span class="token key atrule">default</span><span class="token punctuation">:</span>
    <span class="token key atrule">external</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>proxy
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ul><li>결과 확인</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span>
$ <span class="token function">docker-compose</span> <span class="token function">ps</span>
  Name                 Command               State        Ports
---------------------------------------------------------------------
vuejs-app   /docker-entrypoint.sh ngin <span class="token punctuation">..</span>.   Up      <span class="token number">80</span>/tcp, <span class="token number">8080</span>/tcp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.235aa418.js" defer></script><script src="/assets/js/32.2f97a545.js" defer></script><script src="/assets/js/2.c6e841d7.js" defer></script><script src="/assets/js/1.be22eaca.js" defer></script><script src="/assets/js/73.49fd3654.js" defer></script><script src="/assets/js/39.8f7876c0.js" defer></script><script src="/assets/js/40.0f869326.js" defer></script>
  </body>
</html>
