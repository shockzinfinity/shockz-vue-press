(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{487:function(s,a,t){s.exports=t.p+"assets/img/pg_hba.cfg.cb5093aa.png"},640:function(s,a,t){"use strict";t.r(a);var e=t(25),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"xwiki-설치"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xwiki-설치"}},[s._v("#")]),s._v(" XWiki 설치")]),s._v(" "),a("TagLinks"),s._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#postgresql-설치"}},[s._v("Postgresql 설치")])]),a("li",[a("a",{attrs:{href:"#postgresql-설정파일-변경"}},[s._v("PostgreSQL 설정파일 변경")])]),a("li",[a("a",{attrs:{href:"#xwiki-docker-설치"}},[s._v("Xwiki docker 설치")])])])]),a("p"),s._v(" "),a("h2",{attrs:{id:"postgresql-설치"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#postgresql-설치"}},[s._v("#")]),s._v(" Postgresql 설치")]),s._v(" "),a("blockquote",[a("p",[s._v("CentOS 8 에 기본 설치 패키지 제거 후 설치"),a("br"),s._v("\nPostgreSQL 12 기준"),a("br"),s._v(" "),a("a",{attrs:{href:"https://computingforgeeks.com/how-to-install-postgresql-12-on-centos-7/",target:"_blank",rel:"noopener noreferrer"}},[s._v("참고"),a("OutboundLink")],1)])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ dnf "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" https://download.postgresql.org/pub/repos/yum/reporpms/EL-8-x86_64/pgdg-redhat-repo-latest.noarch.rpm\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-qi")]),s._v(" pgdg-redhat-repo\n$ dnf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-qy")]),s._v(" module disable postgresql\n$ dnf remove postgresql postgresql-server\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dnf -y reinstall postgresql12 postgresql12-server (재설치)")]),s._v("\n$ dnf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" postgresql12 postgresql12-server\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# db 초기화")]),s._v("\n$ /usr/pgsql-12/bin/postgresql-12-setup initdb\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 기존 postgresql 이 실행중일 경우")]),s._v("\n$ systemctl disable "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--now")]),s._v(" postgresql\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# default 로 설치 시 기본설정파일 위치 : /var/lib/pgsql/12/data/postgresql.conf")]),s._v("\n$ systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--now")]),s._v(" postgresql-12\n\n$ firewall-cmd --add-service"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("postgresql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--permanent")]),s._v("\n$ firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--reload")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# admin 계정 초기화")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" - postgres\n$ psql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"ALTER USER postgres WITH PASSWORD 'StrongPassword'\"")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# <vi color 변경> => vi command: color desert")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h2",{attrs:{id:"postgresql-설정파일-변경"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#postgresql-설정파일-변경"}},[s._v("#")]),s._v(" PostgreSQL 설정파일 변경")]),s._v(" "),a("blockquote",[a("p",[s._v("/var/lib/pgsql/12/data/postgresql.conf 상에서")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#listen_addresses = 'localhost,172.17.0.1' 로 변경")]),s._v("\nlisten_addresses "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("WARNING")]),s._v(" "),a("p",[s._v("listen_addresses 를 '*' 로 설정\n시스템 시작 시 docker network listen이 안되는 현상\n근본적인 해결책 찾기 전까지는 * 로 설정")])]),s._v(" "),a("blockquote",[a("p",[s._v("/var/lib/pgsql/12/data/pg_hba.conf 상에서 (screenshot 참조)")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("    all             all             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0/0           md5\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[a("img",{attrs:{src:t(487),alt:"current config"}})])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-an")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5432")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 확인")]),s._v("\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" postgres psql\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("postgres")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CREATE DATABASE xwiki;")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("postgres")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CREATE USER xwikiuser WITH ENCRYPTED PASSWORD 'xwikiuserpassword';")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("postgres")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# GRANT ALL PRIVILEGES ON DATABASE xwiki TO xwikiuser;")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("postgres")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#\\q")]),s._v("\n\n$ psql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" localhost "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-U")]),s._v(" xwikiuser "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" xwiki "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-W")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h2",{attrs:{id:"xwiki-docker-설치"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xwiki-docker-설치"}},[s._v("#")]),s._v(" Xwiki docker 설치")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# xwiki")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--detach")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--publish")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(":8080 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" xwiki "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),s._v(" always "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--volume")]),s._v(" /home/shockz/docker/xwiki/data:/usr/local/xwiki/data "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"DB_USER=xwikiuser"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"DB_PASSWORD=xwikiuserpassword"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"DB_DATABASE=xwiki"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"DB_HOST=172.17.0.1"')]),s._v(" xwiki:stable-postgres\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" xwiki "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\n$ unlink /etc/localtime "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" /usr/share/zoneinfo/Asia/Seoul /etc/localtime "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# in xwiki shell")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ~/docker/xwiki/data/xwiki.cfg 추가 (volume 연결되어 있음)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("xwiki.authentication.ldap")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("xwiki.authentication.class")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("org.xwiki.contrib.ldap.XWikiLDAPAuthServiceImpl\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("xwiki.authentication.ldap.ssl")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("xwiki.authentication.ldap.timeout")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("xwiki.authentication.ldap.trylocal")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])])],1)}),[],!1,null,null,null);a.default=r.exports}}]);