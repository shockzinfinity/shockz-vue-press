(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{622:function(s,a,n){"use strict";n.r(a);var t=n(25),e=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"kubernetes-k8s"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-k8s"}},[s._v("#")]),s._v(" Kubernetes (k8s)")]),s._v(" "),a("TagLinks"),s._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#k8s-환경을-위한-kvm-설치-on-ubuntu-20-04"}},[s._v("k8s 환경을 위한 kvm 설치 (on Ubuntu 20.04)")]),a("ul",[a("li",[a("a",{attrs:{href:"#ssh-를-통한-virt-manager-실행을-위한-작업"}},[s._v("ssh 를 통한 virt-manager 실행을 위한 작업")])]),a("li",[a("a",{attrs:{href:"#docker-kubernetes-설치-버전-확인"}},[s._v("docker, kubernetes 설치 버전 확인")])]),a("li",[a("a",{attrs:{href:"#docker-kubernetes-의-cgroup-변경"}},[s._v("docker, kubernetes 의 cgroup 변경")])]),a("li",[a("a",{attrs:{href:"#metrics-server-설치"}},[s._v("metrics-server 설치")])])])])])]),a("p"),s._v(" "),a("h2",{attrs:{id:"k8s-환경을-위한-kvm-설치-on-ubuntu-20-04"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8s-환경을-위한-kvm-설치-on-ubuntu-20-04"}},[s._v("#")]),s._v(" k8s 환경을 위한 kvm 설치 (on Ubuntu 20.04)")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 리눅스 배포판 확인")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/*-release "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uniq")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DISTRIB_ID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Ubuntu\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DISTRIB_RELEASE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.04")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DISTRIB_CODENAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("focal\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DISTRIB_DESCRIPTION")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Ubuntu 20.04.1 LTS"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Ubuntu"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("VERSION")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"20.04.1 LTS (Focal Fossa)"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 가상화 가능 여부 체크")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("egrep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'(vmx|svm)'")]),s._v(" /proc/cpuinfo\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1 이상이 나와야 함 (보통 cpu 코어 수가 나옴)")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 아래의 명령을 실행해봤을때 실행이 안된다면")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" kvm-ok\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cpu-checker 를 설치")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" cpu-checker\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kvm 관련 패키지 설치")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" qemu qemu-kvm libvirt-daemon libvirt-clients bridge-utils virt-manager\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" kvm-ok\nINFO: /dev/kvm exists\nKVM acceleration can be used\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl status libvirtd\n● libvirtd.service - Virtualization daemon\n     Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/lib/systemd/system/libvirtd.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n     Active: active "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("running"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Mon "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-01-04 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(":09:08 KST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 2s ago\nTriggeredBy: ● libvirtd.socket\n             ● libvirtd-admin.socket\n             ● libvirtd-ro.socket\n       Docs: man:libvirtd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n             https://libvirt.org\n   Main PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7232")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("libvirtd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      Tasks: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("limit: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32768")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n     Memory: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("335")]),s._v(".7M\n     CGroup: /system.slice/libvirtd.service\n             ├─1026 /usr/sbin/dnsmasq --conf-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/libvirt/dnsmasq/default.conf --leasefile-ro --dhcp-script"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/lib/libvirt/libvirt_lease"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n             ├─1027 /usr/sbin/dnsmasq --conf-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/libvirt/dnsmasq/default.conf --leasefile-ro --dhcp-script"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/lib/libvirt/libvirt_lease"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n             └─7232 /usr/sbin/libvirtd\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--now")]),s._v(" libvirtd\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 재부팅이 필요함")]),s._v("\n\n$ lsmod "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" kvm\nkvm_intel             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("282624")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nkvm                   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("663552")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" kvm_intel\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" adduser "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-un")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" libvirt\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" adduser "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-un")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" kvm\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# iso 링크가 동작하지 않거나, size 가 너무 작다면 제대로 받아지지 않은것이므로")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# http://isoredirect.centos.org/centos/7/isos/x86_64/ 에서 링크 다시 확인")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-O")]),s._v(" http://mirror.kakao.com/centos/7.9.2009/isos/x86_64/CentOS-7-x86_64-Minimal-2009.iso\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" CentOS-7-x86_64-Minimal-2009.iso /var/lib/libvirt/images\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("virt-manager")]),s._v(" 구동 시 다음과 같은 에러가 나오는 경우,")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("br")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ virt-manager\nlibGL error: No matching fbConfigs or visuals found\nlibGL error: failed to load driver: swrast\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ul",[a("li",[s._v("swrast 드라이버가 없는 경우이기 때문에 관련 드라이버를 설치해줘야 함.")]),s._v(" "),a("li",[a("code",[s._v("apt install mesa-utils libgl1-mesa-glx")])]),s._v(" "),a("li",[s._v("관련 URL: "),a("a",{attrs:{href:"https://github.com/openai/gym/issues/509",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/openai/gym/issues/509"),a("OutboundLink")],1)])])]),s._v(" "),a("h3",{attrs:{id:"ssh-를-통한-virt-manager-실행을-위한-작업"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh-를-통한-virt-manager-실행을-위한-작업"}},[s._v("#")]),s._v(" ssh 를 통한 virt-manager 실행을 위한 작업")]),s._v(" "),a("blockquote",[a("p",[s._v("ssh 를 통한 virt-manager 접속은 속도가 많이 느림")])]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.xquartz.org",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.xquartz.org"),a("OutboundLink")],1),s._v(" 에서 XQuartz 다운로드")]),s._v(" "),a("li",[a("code",[s._v("ssh -X host.domain.name -p port-number")]),s._v(" 와 같이 접속하며 "),a("code",[s._v("virt-manager")]),s._v(" 를 실행하면 xquartz 를 통해 GUI 가 실행된다.")])]),s._v(" "),a("h3",{attrs:{id:"docker-kubernetes-설치-버전-확인"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-kubernetes-설치-버전-확인"}},[s._v("#")]),s._v(" docker, kubernetes 설치 버전 확인")]),s._v(" "),a("ul",[a("li",[s._v("CentOS 기준")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ yum list docker-ce.x86-64 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--showduplicates")]),s._v("\n$ yum list kubernetes.x86-64 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--showduplicates")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"docker-kubernetes-의-cgroup-변경"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-kubernetes-의-cgroup-변경"}},[s._v("#")]),s._v(" docker, kubernetes 의 cgroup 변경")]),s._v(" "),a("blockquote",[a("p",[s._v("kubernetes 에서 권고하는 cgroup driver 를 systemd 로 변경하기 위한 방법\nkubelet 과 docker 는 cgroupfs 를 사용하고, 나머지 프로세스는 systemd 를 사용하도록 설정된 경우, 리소스가 부족해질때 불안정해지는 현상이 발생될 수 있다. 이로 인한 시스템 리소스 부족 현상이 발생할 수 있으므로 리눅스 init 시스템이 사용하는 cgroups 드라이버와 docker, kubelet 의 드라이버를 맞춰주는 것이 효율적이다.")])]),s._v(" "),a("ul",[a("li",[s._v("docker 의 cgroup 확인")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info\nClient:\n Context:    default\n Debug Mode: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n Plugins:\n  app: Docker App "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Docker Inc., v0.9.1-beta3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  buildx: Build with BuildKit "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Docker Inc., v0.5.1-docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nServer:\n Containers: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  Running: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  Paused: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  Stopped: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n Images: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n Server Version: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.10")]),s._v(".3\n Storage Driver: overlay2\n  Backing Filesystem: extfs\n  Supports d_type: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  Native Overlay Diff: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n Logging Driver: json-file\n Cgroup Driver: cgroupfs\n Cgroup Version: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n Plugins:\n  Volume: "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n  Network: bridge "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" ipvlan macvlan null overlay\n  Log: awslogs fluentd gcplogs gelf journald json-file "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" logentries splunk syslog\n Swarm: inactive\n Runtimes: io.containerd.runtime.v1.linux runc io.containerd.runc.v2\n Default Runtime: runc\n Init Binary: docker-init\n containerd version: 269548fa27e0089a8b8278fc4fc781d7f65a939b\n runc version: ff819c7e9184c13b7c2607fe6c30ae19403a7aff\n init version: de40ad0\n Security Options:\n  apparmor\n  seccomp\n   Profile: default\n Kernel Version: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.8")]),s._v(".0-41-generic\n Operating System: Ubuntu "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.04")]),s._v(".2 LTS\n OSType: linux\n Architecture: x86_64\n CPUs: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\n Total Memory: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".637GiB\n Name: pulseLinux\n ID: U7YY:IBZG:EEGT:U525:O2RL:R6OR:PFD5:FMRN:PXC6:VHLZ:O6FB:6KRA\n Docker Root Dir: /var/lib/docker\n Debug Mode: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n Registry: https://index.docker.io/v1/\n Labels:\n Experimental: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n Insecure Registries:\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.0/8\n Live Restore Enabled: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" cgroup\n Cgroup Driver: cgroupfs\n Cgroup Version: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br")])]),a("blockquote",[a("p",[s._v("kubernetes 에서는 systemd 를 권고함.")])]),s._v(" "),a("ul",[a("li",[s._v("docker cgroup driver 수정")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/docker/daemon.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('EOF\n{\n  "exec-opts": ["native.cgroupdriver=systemd"],\n  "log-driver": "json-file",\n  "log-opts": {\n    "max-size": "100m"\n  },\n  "storage-driver": "overlay2",\n  "dns": ["8.8.8.8", "8.8.4.4"]\n}\nEOF')]),s._v("\n\n$ systemctl daemon-reload\n$ systemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h3",{attrs:{id:"metrics-server-설치"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#metrics-server-설치"}},[s._v("#")]),s._v(" metrics-server 설치")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://github.com/kubernetes-sigs/metrics-server/releases/download/v0.3.7/components.yaml\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# metrics-server container 의 args 조정")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" components.yaml\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n      containers:\n      - name: metrics-server\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n        args:\n        - --cert-dir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/tmp\n        - --secure-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4443")]),s._v("\n        - --kubelet-insecure-tls\n        - --kubelet-preferred-address-types"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("InternalIP,ExternalIP,Hostname\n\n$ k apply "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" components.yaml\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 확인")]),s._v("\n$ k "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" kube-system get deploy,svc\n$ k "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])])],1)}),[],!1,null,null,null);a.default=e.exports}}]);